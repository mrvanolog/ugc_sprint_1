<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="743px" preserveAspectRatio="none" style="width:1320px;height:743px;" version="1.1" viewBox="0 0 1320 743" width="1320px" zoomAndPan="magnify"><defs><filter height="300%" id="f1k6b70y41u70p" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--MD5=[fee662a292a0353a69bd162820bae93b]
entity User--><ellipse cx="22" cy="14" fill="#FEFECE" filter="url(#f1k6b70y41u70p)" rx="8" ry="8" style="stroke:#A80036;stroke-width:1.5;"/><path d="M22,22 L22,49 M9,30 L35,30 M22,49 L9,64 M22,49 L35,64 " fill="none" filter="url(#f1k6b70y41u70p)" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="6" y="82.4951">User</text><!--MD5=[7f62685678746839eddda14500f93391]
entity Analyst--><ellipse cx="350" cy="667" fill="#FEFECE" filter="url(#f1k6b70y41u70p)" rx="8" ry="8" style="stroke:#A80036;stroke-width:1.5;"/><path d="M350,675 L350,702 M337,683 L363,683 M350,702 L337,717 M350,702 L363,717 " fill="none" filter="url(#f1k6b70y41u70p)" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="49" x="325.5" y="735.4951">Analyst</text><!--MD5=[97ab183161fd5d1db7fba7485cf76add]
entity Admin--><ellipse cx="890" cy="509" fill="#FEFECE" filter="url(#f1k6b70y41u70p)" rx="8" ry="8" style="stroke:#A80036;stroke-width:1.5;"/><path d="M890,517 L890,544 M877,525 L903,525 M890,544 L877,559 M890,544 L903,559 " fill="none" filter="url(#f1k6b70y41u70p)" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="868.5" y="577.4951">Admin</text><!--MD5=[9d2073d6101df60eb963db43bcdfbbb7]
entity PostgresMovieData--><path d="M519,403 C519,393 596,393 596,393 C596,393 673,393 673,403 L673,428.2969 C673,438.2969 596,438.2969 596,438.2969 C596,438.2969 519,438.2969 519,428.2969 L519,403 " fill="#FEFECE" filter="url(#f1k6b70y41u70p)" style="stroke:#000000;stroke-width:1.5;"/><path d="M519,403 C519,413 596,413 596,413 C596,413 673,413 673,403 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="134" x="529" y="429.9951">PostgresMovieData</text><!--MD5=[57696ccbf9aff1101ec97a72e7e1fdbc]
entity PostgresAuthData--><path d="M1167,32.5 C1167,22.5 1240,22.5 1240,22.5 C1240,22.5 1313,22.5 1313,32.5 L1313,57.7969 C1313,67.7969 1240,67.7969 1240,67.7969 C1240,67.7969 1167,67.7969 1167,57.7969 L1167,32.5 " fill="#FEFECE" filter="url(#f1k6b70y41u70p)" style="stroke:#000000;stroke-width:1.5;"/><path d="M1167,32.5 C1167,42.5 1240,42.5 1240,42.5 C1240,42.5 1313,42.5 1313,32.5 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="126" x="1177" y="59.4951">PostgresAuthData</text><!--MD5=[b09dc49634ea5d27a4d74e8ef6195a9c]
entity ElasticSearch--><path d="M539,173 C539,163 595,163 595,163 C595,163 651,163 651,173 L651,198.2969 C651,208.2969 595,208.2969 595,208.2969 C595,208.2969 539,208.2969 539,198.2969 L539,173 " fill="#FEFECE" filter="url(#f1k6b70y41u70p)" style="stroke:#000000;stroke-width:1.5;"/><path d="M539,173 C539,183 595,183 595,183 C595,183 651,183 651,173 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="92" x="549" y="199.9951">ElasticSearch</text><!--MD5=[dec244a74f6299e5ec526090fc8e30f8]
entity OLAP--><path d="M322,527.5 C322,517.5 350,517.5 350,517.5 C350,517.5 378,517.5 378,527.5 L378,552.7969 C378,562.7969 350,562.7969 350,562.7969 C350,562.7969 322,562.7969 322,552.7969 L322,527.5 " fill="#FEFECE" filter="url(#f1k6b70y41u70p)" style="stroke:#000000;stroke-width:1.5;"/><path d="M322,527.5 C322,537.5 350,537.5 350,537.5 C350,537.5 378,537.5 378,527.5 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="36" x="332" y="554.4951">OLAP</text><!--MD5=[59ceac3e1bb6f0ece56988f2042cffc2]
entity Kafka--><path d="M321.5,296 C321.5,286 350,286 350,286 C350,286 378.5,286 378.5,296 L378.5,321.2969 C378.5,331.2969 350,331.2969 350,331.2969 C350,331.2969 321.5,331.2969 321.5,321.2969 L321.5,296 " fill="#FEFECE" filter="url(#f1k6b70y41u70p)" style="stroke:#000000;stroke-width:1.5;"/><path d="M321.5,296 C321.5,306 350,306 350,306 C350,306 378.5,306 378.5,296 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="331.5" y="322.9951">Kafka</text><!--MD5=[582f863ae723e21f6009af83c171f753]
entity AdminPanel--><rect fill="#FEFECE" filter="url(#f1k6b70y41u70p)" height="46.2969" style="stroke:#A80036;stroke-width:1.5;" width="121" x="535.5" y="517"/><rect fill="#FEFECE" height="10" style="stroke:#A80036;stroke-width:1.5;" width="15" x="636.5" y="522"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="634.5" y="524"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="634.5" y="528"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="81" x="550.5" y="549.9951">AdminPanel</text><!--MD5=[8589d6d645b4585e5303654ac898cd76]
entity LoadBalancer--><rect fill="#FEFECE" filter="url(#f1k6b70y41u70p)" height="46.2969" style="stroke:#A80036;stroke-width:1.5;" width="133" x="286.5" y="22"/><rect fill="#FEFECE" height="10" style="stroke:#A80036;stroke-width:1.5;" width="15" x="399.5" y="27"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="397.5" y="29"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="397.5" y="33"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="93" x="301.5" y="54.9951">LoadBalancer</text><!--MD5=[9afc680b08cab8a1f61b2b7b734e5125]
entity TokenValidator--><rect fill="#FEFECE" filter="url(#f1k6b70y41u70p)" height="46.2969" style="stroke:#A80036;stroke-width:1.5;" width="143" x="280.5" y="162.5"/><rect fill="#FEFECE" height="10" style="stroke:#A80036;stroke-width:1.5;" width="15" x="403.5" y="167.5"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="401.5" y="169.5"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="401.5" y="173.5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="103" x="295.5" y="195.4951">TokenValidator</text><!--MD5=[645d8587175d8f7ad110cd370775931d]
entity API--><rect fill="#FEFECE" filter="url(#f1k6b70y41u70p)" height="46.2969" style="stroke:#A80036;stroke-width:1.5;" width="61" x="564.5" y="22"/><rect fill="#FEFECE" height="10" style="stroke:#A80036;stroke-width:1.5;" width="15" x="605.5" y="27"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="603.5" y="29"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="603.5" y="33"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="21" x="579.5" y="54.9951">API</text><!--MD5=[39222abbbfd087a4fdab60e627dc976f]
entity Auth--><rect fill="#FEFECE" filter="url(#f1k6b70y41u70p)" height="46.2969" style="stroke:#A80036;stroke-width:1.5;" width="72" x="1055" y="22"/><rect fill="#FEFECE" height="10" style="stroke:#A80036;stroke-width:1.5;" width="15" x="1107" y="27"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="1105" y="29"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="1105" y="33"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="1070" y="54.9951">Auth</text><!--MD5=[c30c8e8d1d0ac977251bea0a17dddab8]
entity ETL--><rect fill="#FEFECE" filter="url(#f1k6b70y41u70p)" height="46.2969" style="stroke:#A80036;stroke-width:1.5;" width="65" x="563.5" y="285.5"/><rect fill="#FEFECE" height="10" style="stroke:#A80036;stroke-width:1.5;" width="15" x="608.5" y="290.5"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="606.5" y="292.5"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="606.5" y="296.5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="25" x="578.5" y="318.4951">ETL</text><!--MD5=[e138d4fead286cc0f44e2ee71a63ee3a]
entity DataAnalysisETL--><rect fill="#FEFECE" filter="url(#f1k6b70y41u70p)" height="46.2969" style="stroke:#A80036;stroke-width:1.5;" width="152" x="274" y="392.5"/><rect fill="#FEFECE" height="10" style="stroke:#A80036;stroke-width:1.5;" width="15" x="406" y="397.5"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="404" y="399.5"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="404" y="403.5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="112" x="289" y="425.4951">DataAnalysisETL</text><!--MD5=[ded2605f68e6c340f2c9007dd3b98953]
link User to LoadBalancer--><path d="M38.4143,45 C82.005,45 202.6991,45 281.2835,45 " fill="none" id="User-to-LoadBalancer" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="286.3975,45,277.3975,41,281.3975,45,277.3975,49,286.3975,45" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="207" x="58.75" y="38.0669">Запрос на просмотр контента</text><!--MD5=[02dfda8818d014e9d183fd83c983d63f]
link LoadBalancer to API--><path d="M419.7682,45 C464.8389,45 522.5671,45 559.1805,45 " fill="none" id="LoadBalancer-to-API" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="564.4253,45,555.4253,41,559.4253,45,555.4253,49,564.4253,45" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="103" x="440.5" y="38.0669">Запрос данных</text><!--MD5=[35b34b4d27a4d3597af9f2ffda93764a]
link API to Auth--><path d="M625.6527,45 C711.2451,45 952.873,45 1049.9101,45 " fill="none" id="API-to-Auth" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="1054.9782,45,1045.9782,41,1049.9782,45,1045.9782,49,1054.9782,45" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="388" x="646.25" y="38.0669">Запрос на аутентификацию/авторизацию пользователя</text><!--MD5=[278f997559c0a73ca85d634c4c4f7833]
link LoadBalancer to TokenValidator--><path d="M352.8349,68.2007 C352.6612,92.6061 352.3877,131.0325 352.2014,157.2021 " fill="none" id="LoadBalancer-to-TokenValidator" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="352.1654,162.2648,356.2293,153.2935,352.201,157.2649,348.2295,153.2366,352.1654,162.2648" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="167" x="354" y="128.5669">Валидация access_token</text><!--MD5=[10f20a53736bbd0ad3ce5e7a638b84e5]
link TokenValidator to Kafka--><path d="M351.6238,208.6354 C351.2907,229.1226 350.8038,259.067 350.4501,280.8194 " fill="none" id="TokenValidator-to-Kafka" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="350.3677,285.8839,354.5137,276.9502,350.4491,280.8846,346.5148,276.82,350.3677,285.8839" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="218" x="353" y="251.5669">Запись событий пользователей</text><!--MD5=[9a7d9be1e32e01223bd1eea915770fd9]
link Kafka to DataAnalysisETL--><path d="M350,331.1919 C350,347.5367 350,369.701 350,387.2019 " fill="none" id="Kafka-to-DataAnalysisETL" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="350,392.4719,354,383.4719,350,387.4719,346,383.4719,350,392.4719" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[a0e4cc03f1b912bae52b7e8f3a6b480b]
link DataAnalysisETL to OLAP--><path d="M350,438.6257 C350,459.4584 350,490.1224 350,512.266 " fill="none" id="DataAnalysisETL-to-OLAP" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="350,517.4179,354,508.4179,350,512.4179,346,508.4179,350,517.4179" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[3800048d5269e6a3815b5d1f971136bb]
reverse link OLAP to Analyst--><path d="M350,567.7452 C350,592.5599 350,629.2465 350,657.3672 " fill="none" id="OLAP-backto-Analyst" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="350,562.6375,346,571.6375,350,567.6375,354,571.6375,350,562.6375" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="103" x="351" y="623.5669">Анализ данных</text><!--MD5=[441578907d10dbe9715c907943c6fd97]
link API to ElasticSearch--><path d="M595,68.2007 C595,92.7522 595,131.4932 595,157.6709 " fill="none" id="API-to-ElasticSearch" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="595,162.731,599,153.731,595,157.731,591,153.731,595,162.731" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[447066ad930b4bf3391389ee3a8d173f]
link Auth to PostgresAuthData--><path d="M1127.0859,45 C1138.5607,45 1150.0354,45 1161.5101,45 " fill="none" id="Auth-to-PostgresAuthData" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="1166.7823,45,1157.7823,41,1161.7823,45,1157.7823,49,1166.7823,45" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[d79fd8e1f425b73722a6e5bc556761ce]
reverse link ETL to PostgresMovieData--><path d="M582.5664,336.9695 C580.2148,354.4033 580.511,376.4151 583.4552,392.6955 " fill="none" id="ETL-backto-PostgresMovieData" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="583.3813,331.7174,578.0488,339.9978,582.6147,336.6583,585.9542,341.2242,583.3813,331.7174" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[fa67b3aa7afeccb297811c414d1a7c46]
link ETL to PostgresMovieData--><path d="M608.6187,331.7174 C611.5183,348.0937 611.7699,370.1145 609.3735,387.4704 " fill="none" id="ETL-to-PostgresMovieData" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="608.5448,392.6955,613.9053,384.4332,609.3281,387.7572,606.0041,383.18,608.5448,392.6955" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[fa2cc15475151b52b3c12e355f2525ca]
reverse link ElasticSearch to ETL--><path d="M595.2245,213.1159 C595.4011,234.8321 595.6443,264.7428 595.811,285.2472 " fill="none" id="ElasticSearch-backto-ETL" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="595.1834,208.0601,591.2568,217.0924,595.2241,213.0599,599.2566,217.0272,595.1834,208.0601" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[427cd29b5a76d0a797ca10b8150b6f73]
reverse link AdminPanel to Admin--><path d="M661.6477,540 C727.5877,540 825.406,540 868.4001,540 " fill="none" id="AdminPanel-backto-Admin" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="656.5605,540,665.5605,544,661.5605,540,665.5605,536,656.5605,540" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="170" x="677.5" y="533.0669">Редактирование данных</text><!--MD5=[1cc5e5282c9624d77ae5998d1be080f1]
reverse link PostgresMovieData to AdminPanel--><path d="M596,443.1906 C596,465.3033 596,495.9331 596,516.7775 " fill="none" id="PostgresMovieData-backto-AdminPanel" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="596,438.046,592,447.046,596,443.046,600,447.046,596,438.046" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[4a261f92be236025e0bc3d09321b01b6]
@startuml
skinparam componentStyle uml2
actor User
actor Analyst
actor Admin
database PostgresMovieData
database PostgresAuthData
database ElasticSearch
database OLAP
database Kafka
component AdminPanel
component LoadBalancer
component TokenValidator
component API
component Auth
component ETL
component DataAnalysisETL

User -right-> LoadBalancer: Запрос на просмотр контента
LoadBalancer -right-> API: Запрос данных
API -right-> Auth: Запрос на аутентификацию/авторизацию пользователя
LoadBalancer -down-> TokenValidator: Валидация access_token
TokenValidator -down-> Kafka: Запись событий пользователей
Kafka -down-> DataAnalysisETL
DataAnalysisETL -down-> OLAP
Analyst -up-> OLAP: Анализ данных
API -down-> ElasticSearch
Auth -right-> PostgresAuthData
PostgresMovieData -up-> ETL
ETL -down-> PostgresMovieData
ETL -up-> ElasticSearch
Admin -left-> AdminPanel: Редактирование данных
AdminPanel -up-> PostgresMovieData
@enduml

PlantUML version 1.2020.22(Sun Dec 06 09:36:27 UTC 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>